#!/usr/bin/env node
import { Command } from 'commander';
import { dbInit, dbMigrate } from '../src/cli/db.js';
import { fetchKlines } from '../src/cli/fetch.js';
import { computeIndicators } from '../src/cli/compute.js';
import { detectPatterns } from '../src/cli/patterns.js';
import { signalsGenerate } from '../src/cli/signals.js';
import { backtestRun } from '../src/cli/backtest.js';

const program = new Command();
program
  .name('cs')
  .description('Crypto Signals CLI');

program.command('db:init').action(dbInit);
program.command('db:migrate').action(dbMigrate);
program.command('fetch:klines').requiredOption('--symbol <symbol>').action(fetchKlines);
program.command('compute:indicators').action(computeIndicators);
program.command('detect:patterns').action(detectPatterns);
program.command('signals:generate').action(signalsGenerate);
program
  .command('backtest:run')
  .requiredOption('--strategy <strategy>')
  .requiredOption('--symbol <symbol>')
  .requiredOption('--from <from>')
  .requiredOption('--to <to>')
  .requiredOption('--initial <initial>')
  .action(backtestRun);

program.parseAsync(process.argv);
